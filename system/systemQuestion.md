# 系統相關問題

- [系統相關問題](#系統相關問題)
  - [架構類](#架構類)
    - [Q. 如何設計一個高並發系統？](#q-如何設計一個高並發系統)
  - [Log 類](#log-類)
    - [Q.分散式系統如何收集 log](#q分散式系統如何收集-log)

---

## 架構類

### Q. 如何設計一個高並發系統？

- 可以透過以下幾點進行設計優化
  - 系統拆分
    - 將不同的功能拆分到不同的服務中，同時要根據系統的業務特點進行合理的分層設計，保證各個服務之間的依賴關係不會太複雜，同時保證每個服務的可伸縮性和高可用性。
  - 緩存
    - 使用緩存來減少對數據庫的訪問，降低數據庫的負載，提高系統的響應速度和並發能力。
  - MQ
    - 透過 MQ 進行
  - 分庫分錶
    - 數據庫水平拆分
      - 可以將單個數據庫拆分成多個數據庫實例，每個數據庫實例負責存儲一部分數據。例如，可以根據用戶 ID 或地理位置將數據拆分到不同的數據庫實例中。
    - 數據庫垂直拆分:
      - 可以將單個數據庫拆分成多個數據庫實例，每個數據庫實例負責存儲特定類型的數據。例如，可以將用戶信息和訂單信息存儲在不同的數據庫實例中。
    - 數據庫分區:
      - 可以將單個數據庫表拆分成多個表，每個表只包含部分數據。例如，可以根據日期或者 ID 將數據拆分到不同的表中。
  - 讀寫分離
    - 讀操作和寫操作分別路由到不同的數據庫節點上，以減輕單個數據庫的壓力，提高數據庫的吞吐量和響應速度。
  - ElasticSearch
    - 使用分佈式架構：Elasticsearch 作為一個分佈式搜索引擎，支持橫向擴展，可以透過增加節點來擴展系統容量。
    - 設計優化的數據模型：在 Elasticsearch 中，數據模型非常重要。良好的數據模型可以減少索引的大小、提高搜索效率和縮短搜索時間。需要考慮數據存儲的格式、字段的映射方式、索引的設計等等。
    - 使用 Elasticsearch 作為緩存：Elasticsearch 的高速搜索和快速寫入特性使其成為一個非常適合作為緩存的搜索引擎。使用 Elasticsearch 作為緩存可以減輕關聯數據庫的負擔，提高系統性能。
    - 進行合理的負載均衡：在使用 Elasticsearch 集群時，需要合理分配負載，保證每個節點的資源利用率，提高系統整體性能。
  - 負載均衡
    - 在高並發場景下，系統會面臨大量的請求，因此需要使用負載均衡來平衡各個服務的請求壓力，將請求分配到不同的服務節點上，以提高系統的處理能力和穩定性。
  - 限流控制
    - 在高並發場景下，需要對請求進行限流控制，以防止系統被惡意攻擊或者過度請求而導致系統崩潰。

---

## Log 類

### Q.分散式系統如何收集 log

1. 集中式收集：
   使用一個中央化的日誌收集服務（如 ELK Stack 或 Splunk），將所有系統的日誌收集到一個中央位置，並進行集中管理和分析。

2. 分散式收集：
   在每個系統上安裝一個輕量級的日誌收集代理（如 Fluentd 或 Filebeat），這些代理將收集本地系統的日誌，然後將日誌轉發到中央化的日誌收集服務進行管理和分析。

3. 分散式收集 + 聚合：
   在每個系統上安裝一個輕量級的日誌收集代理，將日誌轉發到中央化的日誌收集服務進行管理和分析。同時，每個系統還可以使用本地的日誌分析工具（如 Logrotate 或 Logstash），將日誌聚合到本地文件中，以便進行本地的故障排除和分析。
